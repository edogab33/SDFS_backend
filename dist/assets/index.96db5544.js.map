{"version":3,"file":"index.96db5544.js","sources":["../../vite/modulepreload-polyfill","../../api.js","../../classes/GetGridControl.js","../../classes/UndoControl.js","../../classes/StartSimulationControl.js","../../classes/DeleteGridControl.js","../../classes/HorizonControl.js","../../classes/GetSnapshotControl.js","../../main.js"],"sourcesContent":["const p = function polyfill() {\n    const relList = document.createElement('link').relList;\n    if (relList && relList.supports && relList.supports('modulepreload')) {\n        return;\n    }\n    for (const link of document.querySelectorAll('link[rel=\"modulepreload\"]')) {\n        processPreload(link);\n    }\n    new MutationObserver((mutations) => {\n        for (const mutation of mutations) {\n            if (mutation.type !== 'childList') {\n                continue;\n            }\n            for (const node of mutation.addedNodes) {\n                if (node.tagName === 'LINK' && node.rel === 'modulepreload')\n                    processPreload(node);\n            }\n        }\n    }).observe(document, { childList: true, subtree: true });\n    function getFetchOpts(script) {\n        const fetchOpts = {};\n        if (script.integrity)\n            fetchOpts.integrity = script.integrity;\n        if (script.referrerpolicy)\n            fetchOpts.referrerPolicy = script.referrerpolicy;\n        if (script.crossorigin === 'use-credentials')\n            fetchOpts.credentials = 'include';\n        else if (script.crossorigin === 'anonymous')\n            fetchOpts.credentials = 'omit';\n        else\n            fetchOpts.credentials = 'same-origin';\n        return fetchOpts;\n    }\n    function processPreload(link) {\n        if (link.ep)\n            // ep marker = processed\n            return;\n        link.ep = true;\n        // prepopulate the load record\n        const fetchOpts = getFetchOpts(link);\n        fetch(link.href, fetchOpts);\n    }\n};__VITE_IS_MODERN__&&p();","import axios from \"axios\";\n\nconst BASE_URL = 'http://mpm-tlc.ns0.it:4000'\n//const BASE_URL = 'http://localhost:4000'\n\nexport function getGrid(x0,y0,xn,yn) {\n    return axios.get(BASE_URL+'/grid/'+x0+'/'+y0+'/'+xn+'/'+yn)\n}\n\nexport function startSimulation(initialState) {\n    return axios.post(BASE_URL+'/start', initialState)\n}\n\nexport function stopSimulation(simulationId) {\n    var path = '/stop'\n    return axios.post(BASE_URL+path, {\"simulationId\": simulationId})\n}\n\nexport function getSnapshot(simulationId, elapsedminutes) {\n    console.log(elapsedminutes)\n    console.log(parseInt(elapsedminutes))\n    var path = '/snapshot/'+parseInt(simulationId)+'/'+parseInt(elapsedminutes)\n    console.log(path)\n    return axios.get(BASE_URL+path)\n}","import {Vector as VectorSource} from 'ol/source'\nimport {Vector as VectorLayer} from 'ol/layer';\nimport GeoJSON from 'ol/format/GeoJSON';\nimport {Control} from 'ol/control';\nimport {Fill, Stroke, Style} from 'ol/style';\nimport {getGrid} from '../api'\n\nexport class GetGridControl extends Control {\n  /**\n   * @param {Object} [opt_options] Control options.\n   */\n  x0 = 0\n  y0 = 0\n  xn = 0\n  yn = 0\n  map\n  disabled = true\n  addMarker\n  deleteGridController\n  constructor(opt_options, addMarker, deleteGridController) {\n    const options = opt_options || {};\n\n    const button = document.createElement('button');\n    button.innerHTML = 'Ottieni griglia';\n\n    const element = document.createElement('div');\n    element.className = 'ol-control ol-control-disabled ctrl-get-grid';\n    element.appendChild(button);\n\n    super({\n      element: element,\n      target: options.target,\n    });\n\n    this.addMarker = addMarker\n    this.deleteGridController = deleteGridController\n\n    button.addEventListener('click', this.handleGetGrid.bind(this), false);\n  }\n\n  handleGetGrid() {\n    const styles = {\n      'Polygon': new Style({\n        stroke: new Stroke({\n          color: 'blue',\n          width: 1,\n        }),\n        fill: new Fill({\n          color: 'rgba(0, 0, 0, 0.1)',\n        }),\n      }),\n    };\n\n    const styleFunction = function (feature) {\n      return styles[feature.getGeometry().getType()];\n    };\n\n    getGrid(this.x0, this.y0, this.xn, this.yn).then(response => {\n      var grid = response.data\n      if (grid.features.length == 0) {\n        return\n      }\n\n      const vectorSource = new VectorSource({\n        features: new GeoJSON().readFeatures(grid),\n      });\n      const vectorLayer = new VectorLayer({\n        source: vectorSource,\n        style: styleFunction\n      });\n      vectorLayer.set('id', 123)\n      this.map.addLayer(vectorLayer)\n\n      // Remove grid selection markers\n      this.map.un('singleclick', this.addMarker)\n      this.map.getLayers().getArray()\n        .filter(layer => layer.get('id') == 456)\n        .forEach(layer => this.map.removeLayer(layer));\n\n      this.deleteGridController.enableControl()\n      this.disableControl()\n    }).catch(e => {\n      console.error(e)\n    })\n  }\n  \n  enableControl() {\n    this.disabled = false\n    this.element.className = 'ol-control ctrl-get-grid';\n  }\n\n  disableControl() {\n    this.disabled = true\n    this.element.className = 'ol-control ol-control-disabled ctrl-get-grid';\n  }\n}\n","import {Fill, Stroke, Style} from 'ol/style';\nimport {Control} from 'ol/control';\n\nexport class UndoControl extends Control {\n  /**\n   * @param {Object} [opt_options] Control options.\n   */\n  stack = []\n  startSimulationController = 0\n  constructor(opt_options, startSimulationController) {\n    const options = opt_options || {};\n\n    const button = document.createElement('button');\n    button.innerHTML = 'Pulisci';\n\n    const element = document.createElement('div');\n    element.className = 'ol-control ctrl-undo';\n    element.appendChild(button);\n\n    super({\n      element: element,\n      target: options.target,\n    });\n    this.startSimulationController = startSimulationController\n\n    button.addEventListener('click', this.handleUndo.bind(this), false);\n  }\n\n  handleUndo() {\n    if (this.stack.length > 0) {\n      console.log(this.stack)\n      let feature = this.stack.pop()\n      console.log(this.stack)\n      if (this.stack.length > 0) {\n        this.startSimulationController.enableControl()\n      } else {\n        this.startSimulationController.disableControl()\n      }\n      feature.setStyle(new Style({\n        stroke: new Stroke({\n          color: 'blue',\n          width: 1,\n        }),\n        fill: new Fill({\n          color: 'rgba(0, 0, 0, 0.1)',\n        })\n      }))\n    } else {\n      this.startSimulationController.disableControl()\n    }\n  }\n}\n","import {Vector as VectorSource} from 'ol/source'\nimport {Vector as VectorLayer} from 'ol/layer';\nimport GeoJSON from 'ol/format/GeoJSON';\nimport {Control} from 'ol/control';\nimport {Fill, Stroke, Style} from 'ol/style';\nimport {getSnapshot, startSimulation, stopSimulation} from '../api'\n\nexport class StartSimulationControl extends Control {\n    /**\n   * @param {Object} [opt_options] Control options.\n   */\n  initState\n  disabled = true\n  simulationId\n  timer\n  map\n  horizonControl\n  getSnapshotControl\n  constructor(opt_options, horizonControl) {\n    const options = opt_options || {};\n\n    const button = document.createElement('button');\n    button.innerHTML = 'Inizia simulazione';\n\n    const element = document.createElement('div');\n    element.className = 'ol-control ol-control-disabled ctrl-start-simulation';\n    element.appendChild(button);\n\n    super({\n      element: element,\n      target: options.target,\n    });\n\n    this.element = element\n    this.horizonControl = horizonControl\n    button.addEventListener('click', this.handleStartSimulation.bind(this), false);\n  }\n\n  handleStartSimulation() {\n    // send the initial state to the API Service\n    var gridLayer = this.map.getLayers().getArray().filter(layer => layer.get('id') == 123)[0]\n    \n    var gjson = JSON.parse(new GeoJSON().writeFeatures(gridLayer.getSource().getFeatures()))\n    gjson.horizon = this.horizonControl.val.innerHTML\n\n    startSimulation(gjson).then(response => {\n      console.log(\"Simulation started:\")\n      console.log(response)\n      this.simulationId = response.data\n\n      const button = document.createElement('button');\n      button.innerHTML = 'Ferma simulazione';\n\n      this.element.className = 'ol-control ctrl-stop-simulation';\n      this.element.removeChild(this.element.firstChild);\n      this.element.appendChild(button)\n\n      button.addEventListener('click', this.stop.bind(this), false);\n\n      this.getSnapshotControl.simulationId = this.simulationId\n      this.getSnapshotControl.enableControl()\n    })\n    .catch(error => {\n      console.log(error)\n    })\n  }\n\n  stop() {\n    stopSimulation(this.simulationId).then(response => {\n      if (this.timer != undefined) {\n        clearTimeout(this.timer)\n        this.timer = 0\n      }\n\n      const button = document.createElement('button');\n      button.innerHTML = 'Inizia simulazione';\n\n      this.element.className = 'ol-control ctrl-start-simulation';\n      this.element.removeChild(this.element.firstChild);\n      this.element.appendChild(button)\n\n      button.addEventListener('click', this.handleStartSimulation.bind(this), false);\n\n      this.getSnapshotControl.disableControl()\n    })\n    .catch(error => {\n      if (this.timer != 0) {\n        clearTimeout(this.timer)\n        this.timer = 0\n      }\n\n      const button = document.createElement('button');\n      button.innerHTML = 'Inizia simulazione';\n\n      this.element.className = 'ol-control ctrl-start-simulation';\n      this.element.removeChild(this.element.firstChild);\n      this.element.appendChild(button)\n\n      this.getSnapshotControl.disableControl()\n      \n      console.error(error)\n    })\n  }\n\n  enableControl() {\n    console.log(\"enable\")\n    this.disabled = false\n    this.element.className = 'ol-control ctrl-start-simulation';\n  }\n\n  disableControl() {\n    this.disabled = true\n    this.element.className = 'ol-control ol-control-disabled ctrl-start-simulation';\n  }\n}","import {Control} from 'ol/control';\n\nexport class DeleteGridControl extends Control {\n  /**\n   * @param {Object} [opt_options] Control options.\n   */\n  map\n  addMarker\n  getGridController\n  constructor(opt_options, addMarker) {\n    const options = opt_options || {};\n\n    const button = document.createElement('button');\n    button.innerHTML = 'Cancella griglia';\n\n    const element = document.createElement('div');\n    element.className = 'ol-control ol-control-disabled ctrl-delete-grid';\n    element.appendChild(button);\n\n    super({\n      element: element,\n      target: options.target,\n    });\n\n    this.addMarker = addMarker\n\n    button.addEventListener('click', this.handleDeleteGrid.bind(this), false);\n  }\n\n  handleDeleteGrid() {\n    this.map.getLayers().getArray()\n      .filter(layer => layer.get('id') == 123)\n      .forEach(layer => this.map.removeLayer(layer));\n\n    this.map.on('singleclick', this.addMarker)\n    this.disableControl()\n    this.getGridController.disableControl()\n  }\n  \n  enableControl() {\n    this.disabled = false\n    this.element.className = 'ol-control ctrl-delete-grid';\n  }\n\n  disableControl() {\n    this.disabled = true\n    this.element.className = 'ol-control ol-control-disabled ctrl-delete-grid';\n  }\n}\n","import {Control} from 'ol/control';\n\nexport class HorizonControl extends Control {\n    /**\n   * @param {Object} [opt_options] Control options.\n   */\n  min = 10\n  max = 2000\n  horizonSlider\n  val\n  constructor(opt_options) {\n    const options = opt_options || {};\n\n    const element = document.createElement('div');\n    element.className = 'ol-control ctrl-horizon'\n    element.innerHTML = 'Horizon: <input type=\"range\" min=\"'+10+'\" max=\"'+2000+'\" value=\"50\" class=\"slider\" id=\"horizon\">'\n\n    const val = document.createElement('span')\n    val.id = 'val'\n    element.appendChild(val)\n\n    super({\n      element: element,\n      target: options.target,\n    });\n    this.val = val\n    this.element = element\n    //button.addEventListener('click', this.handleStartSimulation.bind(this), false);\n  }\n\n  activateSlider() {\n    this.horizonSlider = document.getElementById('horizon')\n\n    this.val.innerHTML = this.horizonSlider.value\n\n    this.horizonSlider.oninput = function() {\n      document.getElementById('val').innerHTML = document.getElementById('horizon').value\n    }\n  }\n}","import {Vector as VectorSource} from 'ol/source'\nimport {Vector as VectorLayer} from 'ol/layer';\nimport GeoJSON from 'ol/format/GeoJSON';\nimport {Control} from 'ol/control';\nimport {Fill, Stroke, Style} from 'ol/style';\nimport {getSnapshot} from '../api'\n\nexport class GetSnapshotControl extends Control {\n    /**\n   * @param {Object} [opt_options] Control options.\n   */\n  elapsedMinutesSlider\n  simulationId\n  elapsedminutes\n  min = 10\n  max = 2000\n  map\n  disabled = true\n  constructor(opt_options) {\n    const options = opt_options || {};\n\n    const element = document.createElement('div');\n    element.className = 'ol-control ol-control-disabled ctrl-get-snapshot'\n    element.innerHTML = 'Snapshot: <input type=\"range\" min=\"'+0+'\" max=\"'+2000+'\" step=\"10\" value=\"0\" class=\"slider\" id=\"elapsedminutes\">'\n\n    const val = document.createElement('span')\n    val.id = 'val_em'\n    element.appendChild(val)\n\n    const button = document.createElement('button');\n    button.innerHTML = 'Scarica snapshot';\n    element.appendChild(button)\n\n    super({\n      element: element,\n      target: options.target,\n    });\n\n    this.elapsedminutes = val\n    this.element = element\n    button.addEventListener('click', this.handleGetSnapshot.bind(this), false);\n  }\n\n  handleGetSnapshot() {\n    var styles = new Style({\n      stroke: new Stroke({color: 'blue', width: 1}),\n      fill: new Fill()\n    });\n\n    var styleFunction = function(feature) {\n      var fire = feature.get('fire');\n      var color = ''\n      if (fire == 0) {\n        color = 'rgba(0, 0, 0, 0.1)'\n      } else if (fire == 1) {\n        color = 'rgba(255, 0, 0, 0.3)'\n      } else {\n        color = 'rgba(255, 255, 0, 0.3)'\n      }\n      styles.getFill().setColor(color);\n      return styles;\n    };\n\n    getSnapshot(this.simulationId, this.elapsedminutes.innerHTML).then(response => {\n      var grid = response.data\n      console.log(\"New grid from snapshot:\")\n      console.log(grid)\n\n      if (grid.features.length > 0) {\n        // Update the grid only if there are updates\n        const vectorSource = new VectorSource({\n          features: new GeoJSON().readFeatures(grid),\n        });\n\n        const vectorLayer = new VectorLayer({\n          source: vectorSource,\n          style: styleFunction\n        });\n        vectorLayer.set('id', 123)\n\n        // Remove old grid\n        this.map.getLayers().getArray()\n          .filter(layer => layer.get('id') == 123)\n          .forEach(layer => this.map.removeLayer(layer));\n\n        this.map.addLayer(vectorLayer)\n      }\n    })\n    .catch(error => {\n      console.log(error)\n    })\n  }\n\n  activateSlider() {\n    this.elapsedMinutesSlider = document.getElementById('elapsedminutes')\n\n    this.elapsedminutes.innerHTML = this.elapsedMinutesSlider.value\n\n    this.elapsedMinutesSlider.oninput = function() {\n      document.getElementById('val_em').innerHTML = document.getElementById('elapsedminutes').value\n    }\n  }\n\n  enableControl() {\n    this.disabled = false\n    this.element.className = 'ol-control ctrl-get-snapshot';\n  }\n\n  disableControl() {\n    this.disabled = true\n    this.element.className = 'ol-control ol-control-disabled ctrl-get-snapshot';\n  }\n}","import 'ol/ol.css';\nimport MVT from 'ol/format/MVT';\nimport Map from 'ol/Map';\nimport TileGrid from 'ol/tilegrid/TileGrid';\nimport VectorTileLayer from 'ol/layer/VectorTile';\nimport VectorTileSource from 'ol/source/VectorTile';\nimport View from 'ol/View';\nimport proj4 from 'proj4';\nimport {Fill, Icon, Stroke, Style, Text, Circle} from 'ol/style';\nimport {get as getProjection, getTransform} from 'ol/proj';\nimport {register} from 'ol/proj/proj4';\nimport {applyTransform, approximatelyEquals} from 'ol/extent';\nimport {OSM, Vector as VectorSource} from 'ol/source'\nimport TileLayer from 'ol/layer/Tile';\nimport {Vector as VectorLayer} from 'ol/layer';\nimport {defaults as defaultControls} from 'ol/control';\nimport Feature from 'ol/Feature';\nimport Point from 'ol/geom/Point';\nimport Geolocation from 'ol/Geolocation';\nimport { GetGridControl } from './classes/GetGridControl';\nimport { UndoControl } from './classes/UndoControl';\nimport { StartSimulationControl } from './classes/StartSimulationControl'\nimport { DeleteGridControl } from './classes/DeleteGridControl'\nimport { HorizonControl } from './classes/HorizonControl'\nimport { GetSnapshotControl } from './classes/GetSnapshotControl'\n\nlet code = \"3035\"\nlet name = \"ETRS89-extended / LAEA Europe\"\nlet proj4def = \"+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs\"\nlet bbox = [84.17, -35.58, 24.6, 44.83]\nconst newProjCode = 'EPSG:' + code;\n\nconst addMarker = function (evt) {\n  console.log(\"coordinates: \"+evt.coordinate);\n  if (tapCount < 2) {\n    const iconFeature = new Feature({\n      geometry: new Point(evt.coordinate),\n      name: 'Point'\n    });\n\n    iconFeature.setStyle(iconStyle);\n    pointSource.addFeature(iconFeature)\n    pointLayer.setSource(pointSource)\n    pointLayer.set('id', 456)\n\n    tapCount += 1\n    if (tapCount == 1) {\n      getGridController.x0 = evt.coordinate[0]\n      getGridController.y0 = evt.coordinate[1]\n    } else if (tapCount == 2) {\n      getGridController.xn = evt.coordinate[0]\n      getGridController.yn = evt.coordinate[1]\n      getGridController.enableControl()\n    }\n  } else if (tapCount >= 2) {\n    tapCount = 0\n    pointSource.clear()   // delete markers\n    getGridController.disableControl()\n  }\n}\n\nproj4.defs(newProjCode, proj4def);\nregister(proj4);\nconst newProj = getProjection(newProjCode);\nconst fromLonLat = getTransform('EPSG:4326', newProj);\n\nlet worldExtent = [bbox[1], bbox[2], bbox[3], bbox[0]];\nnewProj.setWorldExtent(worldExtent);\n\n// approximate calculation of projection extent,\n// checking if the world extent crosses the dateline\nif (bbox[1] > bbox[3]) {\n  worldExtent = [bbox[1], bbox[2], bbox[3] + 360, bbox[0]];\n}\nconst extent = applyTransform(worldExtent, fromLonLat, undefined, 8);\nnewProj.setExtent(extent);\n\nlet startSimulationController = new StartSimulationControl()\nlet deleteGridController = new DeleteGridControl(\"\", addMarker)\nlet getGridController = new GetGridControl(\"\", addMarker, deleteGridController)\nlet undoController = new UndoControl(\"\", startSimulationController)\nlet horizonController = new HorizonControl()\nlet getSnapshotController = new GetSnapshotControl()\n\nconst map = new Map({\n  controls: defaultControls().extend([getGridController, deleteGridController, undoController, startSimulationController, \n                                      horizonController, getSnapshotController]),\n  layers: [\n    new TileLayer({\n      source:new OSM()\n    })\n  ],\n  target: 'map',\n  view: new View({\n    projection: newProj,\n    center: [4559505, 2121005],\n    extent: extent,\n    zoom: 16,\n  }),\n});\n\ndeleteGridController.getGridController = getGridController\ndeleteGridController.map = map\ngetGridController.map = map\nstartSimulationController.map = map\ngetSnapshotController.map = map\nhorizonController.activateSlider()\nstartSimulationController.horizonControl = horizonController\nstartSimulationController.getSnapshotControl = getSnapshotController\ngetSnapshotController.activateSlider()\n\n/* GEOLOCATION */\nconst geolocation = new Geolocation({\n  trackingOptions: {\n    enableHighAccuracy: true,\n  },\n  projection: newProj,\n});\n\ngeolocation.setTracking(true);\n\nconst accuracyFeature = new Feature();\ngeolocation.on('change:accuracyGeometry', function () {\n  accuracyFeature.setGeometry(geolocation.getAccuracyGeometry());\n});\n\nconst positionFeature = new Feature();\npositionFeature.setStyle(\n  new Style({\n    image: new Circle({\n      radius: 6,\n      fill: new Fill({\n        color: '#3399CC',\n      }),\n      stroke: new Stroke({\n        color: '#fff',\n        width: 2,\n      }),\n    }),\n  })\n);\n\ngeolocation.on('change:position', function () {\n  const coordinates = geolocation.getPosition();\n  positionFeature.setGeometry(coordinates ? new Point(coordinates) : null);\n});\n\n/* EVENTS */\nvar currZoom = map.getView().getZoom();\nconsole.log(currZoom)\nmap.on('moveend', function(e) {\n  var newZoom = map.getView().getZoom();\n  if (currZoom != newZoom) {\n    console.log('zoom end, new zoom: ' + newZoom);\n    currZoom = newZoom;\n  }\n});\n\nconst clickCell = function (pixel) {\n  let features = map.getFeaturesAtPixel(pixel)\n\n  if (features[0] != undefined) {\n    // Never-clicked cells have no style\n    if (features[0].getStyle() == null) {\n      undoController.stack.push(features[0])\n    } else if (features[0].getStyle() != null) {\n      if (features[0].getStyle().fill_.color_ == 'rgba(0, 0, 0, 0.1)') {\n        // Cell has been clicked, removed from the stack and clicked again\n        undoController.stack.push(features[0])\n      }\n    }\n\n    if (undoController.stack.length > 0) {\n      startSimulationController.enableControl()\n    }\n\n    features[0].setStyle(new Style({\n      stroke: new Stroke({\n        color: 'blue',\n        width: 1,\n      }),\n      fill: new Fill({\n        color: 'rgba(255, 0, 0, 0.3)',\n      })\n    }))\n    features[0].setProperties({\"fire\": 1})\n  }\n};\n\nmap.on('click', function (evt) {\n  clickCell(evt.pixel);\n});\n const fill = new Fill({\n   color: 'rgba(255,255,255,0.4)',\n });\n const stroke = new Stroke({\n   color: '#3399CC',\n   width: 1.25,\n });\nconst iconStyle = new Style({\n  image: new Circle({\n    fill: fill,\n    stroke: stroke,\n    radius: 5,\n  }),\n  fill: fill,\n  stroke: stroke,\n});\n\nconst pointSource = new VectorSource({\n  features: [],\n});\nconst pointLayer = new VectorLayer();\nmap.addLayer(pointLayer)\nlet tapCount = 0\n\nmap.on('singleclick', addMarker);"],"names":["getProjection","defaultControls"],"mappings":"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"}